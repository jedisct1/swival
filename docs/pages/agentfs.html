<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AgentFS — Swival</title>
    <meta name="description" content="AgentFS — Swival documentation">
    <meta property="og:type" content="article">
    <meta property="og:title" content="AgentFS — Swival">
    <meta property="og:description" content="AgentFS — Swival documentation">
    <meta property="og:image" content="https://swival.github.io/swival/img/logo.png">
    <meta property="og:url" content="https://swival.github.io/swival/pages/agentfs.html">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="AgentFS — Swival">
    <meta name="twitter:description" content="AgentFS — Swival documentation">
    <meta name="twitter:image" content="https://swival.github.io/swival/img/logo.png">
    <link rel="icon" href="../favicon.ico">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header class="site-header">
        <div class="header-inner">
            <a href="../" class="header-logo">
                <img src="../img/logo.png" alt="Swival">
            </a>
            <nav class="header-nav">
                <a href="./">Docs</a>
                <a href="https://github.com/swival/swival">GitHub</a>
            </nav>
        </div>
    </header>
    <div class="docs-layout">
        <aside class="sidebar">
            <div class="sidebar-section">
<h4>Basics</h4>
<ul>
<li><a href="getting-started.html">Getting Started</a></li>
<li><a href="usage.html">Usage</a></li>
<li><a href="tools.html">Tools</a></li>
</ul>
</div>
<div class="sidebar-section">
<h4>Configuration & Deployment</h4>
<ul>
<li><a href="safety-and-sandboxing.html">Safety & Sandboxing</a></li>
<li><a href="skills.html">Skills</a></li>
<li><a href="customization.html">Customization</a></li>
<li><a href="providers.html">Providers</a></li>
<li><a href="reports.html">Reports</a></li>
<li><a href="reviews.html">Reviews</a></li>
<li><a href="agentfs.html" class="active">AgentFS</a></li>
</ul>
</div>
        </aside>
        <article class="docs-content">
            <h1 id="using-swival-with-agentfs">Using Swival With AgentFS</h1>
<p><a href="https://www.agentfs.ai/">AgentFS</a> gives Swival a copy-on-write filesystem overlay. The agent can edit freely, but your real project files remain unchanged until you explicitly copy changes back. This is a practical workflow for high-autonomy runs because you can inspect and test everything before applying it.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Install AgentFS first.</p>
<pre><code class="language-sh">curl -fsSL https://agentfs.ai/install | bash
</code></pre>
<p>You also need a working model provider for Swival itself, such as LM Studio or HuggingFace.</p>
<h2 id="run-swival-inside-a-session-overlay">Run Swival Inside A Session Overlay</h2>
<p><code>agentfs run</code> wraps a command in a session-backed sandbox. If you name the session, you can return to the same overlay state later.</p>
<pre><code class="language-sh">cd ~/my-project

agentfs run --session add-config -- \
    swival &quot;Add a config module that reads from env vars, and update main.py to use it&quot; --yolo --max-turns 20
</code></pre>
<p>This pairing of AgentFS and <code>--yolo</code> is intentional. AgentFS provides filesystem isolation externally, so Swival can run with full command and file capability without mutating your real tree.</p>
<p>After the run, your working copy is unchanged. The overlay delta for this example lives at <code>~/.agentfs/run/add-config/delta.db</code>.</p>
<h2 id="review-the-delta">Review The Delta</h2>
<p>You can inspect which paths were added or modified with <code>agentfs diff</code>.</p>
<pre><code class="language-sh">agentfs diff ~/.agentfs/run/add-config/delta.db
</code></pre>
<p>A typical short output looks like this:</p>
<pre><code>A f /src/config.py
M f /src/main.py
</code></pre>
<h2 id="validate-inside-the-overlay">Validate Inside The Overlay</h2>
<p>Re-enter the same session as a shell, then run tests or manual checks against the overlay view.</p>
<pre><code class="language-sh">agentfs run --session add-config -- bash
</code></pre>
<p>Inside that shell, run your usual checks.</p>
<pre><code class="language-sh">python -m pytest tests/ -v
python src/main.py
</code></pre>
<p>If validation fails, exit and ask Swival for another pass using the same session name.</p>
<h2 id="apply-changes-to-the-real-project">Apply Changes To The Real Project</h2>
<p>Once you are satisfied, copy only the files you want back into your actual working tree.</p>
<pre><code class="language-sh">agentfs run --session add-config -- \
    sh -c 'cp src/config.py ~/my-project/src/config.py &amp;&amp; cp src/main.py ~/my-project/src/main.py'
</code></pre>
<p>For larger updates, <code>rsync</code> is often easier.</p>
<pre><code class="language-sh">agentfs run --session add-config -- \
    rsync -av src/ ~/my-project/src/
</code></pre>
<p>Then commit normally in your project directory.</p>
<pre><code class="language-sh">cd ~/my-project
git add src/config.py src/main.py
git commit -m &quot;Add config module&quot;
</code></pre>
<p>If you decide not to keep the work, delete the session directory at <code>~/.agentfs/run/add-config/</code> and your real project remains untouched.</p>
<h2 id="iterate-without-starting-over">Iterate Without Starting Over</h2>
<p>You can continue improving the same feature by reusing the session name. Each run sees prior overlay changes.</p>
<pre><code class="language-sh">agentfs run --session add-config -- \
    swival &quot;The tests are failing because config.py doesn't handle missing env vars. Fix it.&quot; --yolo
</code></pre>
<p>This lets you run a natural loop of generate, validate, and refine before applying files.</p>
<h2 id="alternative-workflow-with-agentfs-init-c">Alternative Workflow With <code>agentfs init -c</code></h2>
<p>If you prefer a project-local overlay database, initialize AgentFS in the repo and run Swival through <code>-c</code>.</p>
<pre><code class="language-sh">cd ~/my-project

agentfs init --base . -c \
    'swival &quot;Add a config module&quot; --yolo --max-turns 20' \
    add-config
</code></pre>
<p>This writes <code>.agentfs/add-config.db</code>. You can diff by session name.</p>
<pre><code class="language-sh">agentfs diff add-config
</code></pre>
<p>You can also inspect files in that overlay directly without mounting.</p>
<pre><code class="language-sh">agentfs fs add-config cat /src/config.py
</code></pre>
<p>For testing and selective apply, mount the overlay.</p>
<pre><code class="language-sh">mkdir -p /tmp/sandbox
agentfs mount -f --auto-unmount add-config /tmp/sandbox &amp;

cd /tmp/sandbox
python -m pytest tests/ -v
cp src/config.py ~/my-project/src/

kill %1
</code></pre>
<p>If you do not want the result, remove <code>.agentfs/add-config.db</code>.</p>
<h2 id="alternative-workflow-for-repl-sessions">Alternative Workflow For REPL Sessions</h2>
<p>For live conversational editing, mount first and point Swival's base directory at the mount.</p>
<pre><code class="language-sh">cd ~/my-project
agentfs init --base . sandbox
mkdir -p /tmp/sandbox
agentfs mount -f --auto-unmount sandbox /tmp/sandbox
</code></pre>
<p>In another terminal, run REPL mode against the mounted view.</p>
<pre><code class="language-sh">swival --repl --base-dir /tmp/sandbox --yolo
</code></pre>
<p>This setup gives you an interactive agent session while you test changes from a separate terminal against the mounted sandbox.</p>
<h2 id="practical-guidance">Practical Guidance</h2>
<p>In day-to-day use, AgentFS plus <code>--yolo</code> is often the most productive combination because it gives the model full capability while still protecting your real workspace. Session names make iteration resumable across multiple agent runs. Swival does not need special AgentFS integration because it simply sees whatever filesystem tree you point it at, whether that tree is your real directory or a mounted copy-on-write overlay.</p>
        </article>
    </div>
    <footer class="site-footer">
        MIT License &middot;
        <a href="https://github.com/swival/swival">GitHub</a>
    </footer>
</body>
</html>